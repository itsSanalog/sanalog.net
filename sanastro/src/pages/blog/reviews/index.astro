---
import { getCollection, getEntry } from "astro:content";
import { Image } from "astro:assets";
import BlogLayout from "../../../layouts/BlogLayout.astro";
import Collapsible from "../../../components/blog/Collapsible.astro";

const musicReviews = await getCollection("reviews", ({ id }) => {
  return id.startsWith("music/");
});
musicReviews.sort((a, b) => {
  return b.data.sortOrder - a.data.sortOrder;
});

const gameReviews = await getCollection("reviews", ({ id }) => {
  return id.startsWith("games/");
});
gameReviews.sort((a, b) => {
  return b.data.sortOrder - a.data.sortOrder;
});

const filmReviews = await getCollection("reviews", ({ id }) => {
  return id.startsWith("film/");
});
filmReviews.sort((a, b) => {
  return b.data.sortOrder - a.data.sortOrder;
});

const mangaReviews = await getCollection("reviews", ({ id }) => {
  return id.startsWith("manga-webtoons/");
});
mangaReviews.sort((a, b) => {
  return b.data.sortOrder - a.data.sortOrder;
});

const toolReviews = await getCollection("reviews", ({ id }) => {
  return id.startsWith("tools/");
});
toolReviews.sort((a, b) => {
  return b.data.sortOrder - a.data.sortOrder;
});

const preface = await getEntry("reviews", "preface");
const { Content } = await preface.render();
---

<BlogLayout title="Reviews">
  <content>
    <p class="muted">quick links</p>
    <!-- To use centerdot or | is a good UI question, as well as using &centerdot; over &xB7; for clarity -->
    <a href="reviews/music"   class="plain mmr">music</a>&centerdot;
    <a href="reviews/games"    class="plain mml mmr">games</a>&centerdot;
    <a href="reviews/film"    class="plain mml mmr">film</a>&centerdot;
    <a href="reviews/webtoon" class="plain mml mmr">webtoon</a>&centerdot;
    <a href="reviews/tools"    class="plain mml">tools</a>
    
    <Content />

    <!-- <Collapsible name="music">
      {
        musicReviews.map((review) => (
          <a href={ `/blog/${ review.slug }` } class="plain">
            <Image src={ review.data.cover } alt={ review.data.coverAlt } />
            <h2 style="margin-top: 1rem;">{ review.data.title }</h2>
            <p>{ review.data.rating }</p>
          </a>
        ))
      }
    </Collapsible> -->
  </content>
</BlogLayout>