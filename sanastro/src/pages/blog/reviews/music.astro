---
import { getCollection, getEntry } from "astro:content";
// import { Image } from "astro:assets";
import BlogLayout from "../../../layouts/BlogLayout.astro";

const musicReviews = await getCollection("reviews", ({ id }) => {
  return id.startsWith("music/");
});
musicReviews.sort((a, b) => {
  return (b.data.sortOrder ?? 0) - (a.data.sortOrder ?? 0);
});

---

<BlogLayout title="Music">
  <content>
    <h1>music</h1>
    <select id="sortCriteria">
      <option value="sortOrder">Sort Order</option>
      <option value="releaseDate">Release Date</option>
      <option value="artistName">Artist Name</option>
    </select>
    
    <table>
      { musicReviews.map((review) => {
          // take year from releaseDate
          const year = new Date(review.data.releaseDate ?? '').getFullYear();
          return(
          <tr>
            <td class="column-image">
              <a href={ `/blog/reviews/${ review.slug }` }>
                <img src={ review.data.imageLink } alt={ review.data.imageAlt } />
              </a>
            </td>
            <td>
              <a href={ `/blog/reviews/${ review.slug }` } class="plain">{ review.data.title }</a>
              <br />
              <span class="muted">{ review.data.artist } &centerdot; { year }</span>
            </td>
            <td><span class="muted">{ review.data.publicationDate?.toLocaleDateString('ko-KR') }</span></td>
            <td>{ review.data.rating }</td>
          </tr>
      )}) }
    </table>
  </content>
</BlogLayout>

<style>
  .column-image {
    width: 4em;
  }

  .column-image img {
    border-radius: 0;
    /* transition: border-width 50ms; */
  }

  .column-image img:hover {
    border-style: solid;
    border: 1px solid transparent;

  }
</style>